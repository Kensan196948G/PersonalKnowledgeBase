# E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆ

**å®Ÿè¡Œæ—¥æ™‚**: 2025-12-14
**ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: Playwright
**ãƒ†ã‚¹ãƒˆå¯¾è±¡**: ãƒãƒ¼ãƒˆé–“ãƒªãƒ³ã‚¯æ©Ÿèƒ½ï¼ˆPhase 3ï¼‰

---

## ãƒ†ã‚¹ãƒˆå®Ÿè¡ŒçŠ¶æ³

### ã‚µãƒ¼ãƒãƒ¼çŠ¶æ…‹
- **Frontend**: http://192.168.0.187:5173/ - èµ·å‹•ä¸­ï¼ˆ200 OKï¼‰
- **Backend**: http://192.168.0.187:3000/ - èµ·å‹•ä¸­ï¼ˆ200 OKï¼‰
- **ãƒ—ãƒ­ã‚»ã‚¹ç¢ºèª**: æ­£å¸¸ç¨¼åƒä¸­

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ä¸€è¦§ï¼ˆå…¨8ã‚·ãƒŠãƒªã‚ªï¼‰

| # | ãƒ†ã‚¹ãƒˆã‚·ãƒŠãƒªã‚ª | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|---|---------------|-----------|
| 1 | ã‚·ãƒŠãƒªã‚ª1: [[ãƒãƒ¼ãƒˆå]] ã§ãƒªãƒ³ã‚¯ãŒä½œæˆã•ã‚Œã‚‹ | **å¤±æ•—** |
| 2 | ã‚·ãƒŠãƒªã‚ª2: ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯ã§å¯¾è±¡ãƒãƒ¼ãƒˆã«é·ç§»ã™ã‚‹ | **å¤±æ•—** |
| 3 | ã‚·ãƒŠãƒªã‚ª3: ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ãƒ‘ãƒãƒ«ã«å‚ç…§å…ƒãƒãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ | **å¤±æ•—** |
| 4 | ã‚·ãƒŠãƒªã‚ª4: é–¢é€£ãƒãƒ¼ãƒˆã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã«ã‚¹ã‚³ã‚¢ä»˜ãã§è¡¨ç¤ºã•ã‚Œã‚‹ | **å¤±æ•—** |
| 5 | ã‚·ãƒŠãƒªã‚ª5: å­˜åœ¨ã—ãªã„ãƒãƒ¼ãƒˆã¸ã®ãƒªãƒ³ã‚¯ã¯èµ¤è‰²ã§è¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆèµ¤ãƒªãƒ³ã‚¯ï¼‰ | **å¤±æ•—** |
| 6 | è¿½åŠ ã‚·ãƒŠãƒªã‚ª: ãƒªãƒ³ã‚¯å‰Šé™¤å¾Œã«ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ãŒæ›´æ–°ã•ã‚Œã‚‹ | **å¤±æ•—** |
| 7 | è¿½åŠ ã‚·ãƒŠãƒªã‚ª: åŒæ–¹å‘ãƒªãƒ³ã‚¯ãŒæ­£ã—ãå‹•ä½œã™ã‚‹ | **å¤±æ•—** |
| 8 | ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹: å¤§é‡ã®ãƒªãƒ³ã‚¯ã§ã‚‚å¿«é©ã«å‹•ä½œã™ã‚‹ | **å¤±æ•—** |

---

## ã‚¨ãƒ©ãƒ¼è©³ç´°

### æ ¹æœ¬åŸå› 
**ãƒ–ãƒ©ã‚¦ã‚¶ä¾å­˜é–¢ä¿‚ã®ä¸è¶³**

Playwright Chromiumã®å®Ÿè¡Œã«å¿…è¦ãªã‚·ã‚¹ãƒ†ãƒ å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚

### ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
```
Error: browserType.launch: Target page, context or browser has been closed
Browser logs:
[pid=164901][err] chrome-headless-shell: error while loading shared libraries:
libatk-1.0.so.0: cannot open shared object file: No such file or directory
```

### ä¸è¶³ã—ã¦ã„ã‚‹å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆlddå‡ºåŠ›ï¼‰
```
libatk-1.0.so.0 => not found
libatk-bridge-2.0.so.0 => not found
libatspi.so.0 => not found
libXcomposite.so.1 => not found
libXdamage.so.1 => not found
libXfixes.so.3 => not found
libXrandr.so.2 => not found
libgbm.so.1 => not found
libasound.so.2 => not found
```

---

## ä¿®å¾©æ‰‹é †

### æ‰‹é †1: Playwrightä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæ¨å¥¨ï¼‰

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ï¼ˆsudoãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¿…è¦ã§ã™ï¼‰:

```bash
# PlaywrightãŒä¾å­˜ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npx playwright install-deps chromium
```

ã“ã®ã‚³ãƒãƒ³ãƒ‰ã¯ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ï¼ˆUbuntu/Debianç³»ï¼‰:
- libatk1.0-0
- libatk-bridge2.0-0
- libatspi2.0-0
- libxcomposite1
- libxdamage1
- libxfixes3
- libxrandr2
- libgbm1
- libasound2
- ãã®ä»–Chromiumã«å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒª

### æ‰‹é †2: ãƒ†ã‚¹ãƒˆã®å†å®Ÿè¡Œ

ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€ãƒ†ã‚¹ãƒˆã‚’å†å®Ÿè¡Œ:

```bash
npm run test:e2e
```

### ä»£æ›¿æ‰‹é †: æ‰‹å‹•ã§ä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

Playwrightã®è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå‹•ä½œã—ãªã„å ´åˆã€æ‰‹å‹•ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«:

**Ubuntu/Debianç³»**:
```bash
sudo apt-get update
sudo apt-get install -y \
  libnss3 \
  libatk1.0-0 \
  libatk-bridge2.0-0 \
  libcups2 \
  libdrm2 \
  libxkbcommon0 \
  libxcomposite1 \
  libxdamage1 \
  libxfixes3 \
  libxrandr2 \
  libgbm1 \
  libasound2 \
  libpango-1.0-0 \
  libcairo2 \
  libatspi2.0-0
```

**Fedora/RHELç³»**:
```bash
sudo dnf install -y \
  nss \
  atk \
  at-spi2-atk \
  cups-libs \
  libdrm \
  libXcomposite \
  libXdamage \
  libXfixes \
  libXrandr \
  mesa-libgbm \
  alsa-lib \
  pango \
  cairo \
  at-spi2-core
```

---

## ãƒ†ã‚¹ãƒˆè¨­å®šæƒ…å ±

### Playwrightè¨­å®šï¼ˆplaywright.config.tsï¼‰
```typescript
{
  testDir: './tests/e2e',
  baseURL: 'http://192.168.0.187:5173',
  webServer: {
    command: 'npm run dev',
    url: 'http://192.168.0.187:5173',
    reuseExistingServer: true
  },
  use: {
    actionTimeout: 30000,
    navigationTimeout: 30000,
    screenshot: 'only-on-failure',
    video: 'retain-on-failure'
  }
}
```

### ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«
- **å ´æ‰€**: `/mnt/LinuxHDD/PersonalKnowledgeBase/tests/e2e/noteLinks.spec.ts`
- **ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹æ•°**: 8
- **ã‚«ãƒãƒ¼æ©Ÿèƒ½**:
  - ãƒãƒ¼ãƒˆé–“ãƒªãƒ³ã‚¯ä½œæˆï¼ˆ[[ãƒãƒ¼ãƒˆå]]ï¼‰
  - ã‚ªãƒ¼ãƒˆã‚³ãƒ³ãƒ—ãƒªãƒ¼ãƒˆ
  - ãƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯é·ç§»
  - ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯è¡¨ç¤º
  - é–¢é€£ãƒãƒ¼ãƒˆææ¡ˆ
  - é’ãƒªãƒ³ã‚¯/èµ¤ãƒªãƒ³ã‚¯è¡¨ç¤º
  - åŒæ–¹å‘ãƒªãƒ³ã‚¯
  - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆï¼ˆ10ãƒãƒ¼ãƒˆï¼‰

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«** (ä¿®å¾©æ‰‹é †1ã¾ãŸã¯ä»£æ›¿æ‰‹é †ã‚’å®Ÿè¡Œ)
2. **ãƒ†ã‚¹ãƒˆã®å†å®Ÿè¡Œ** (`npm run test:e2e`)
3. **çµæœã®ç¢ºèª**:
   - æˆåŠŸ: HTMLãƒ¬ãƒãƒ¼ãƒˆ `playwright-report/index.html` ã‚’ç¢ºèª
   - å¤±æ•—: ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆãƒ»ãƒ“ãƒ‡ã‚ªã‚’ç¢ºèªã—ã¦å…·ä½“çš„ãªå•é¡Œã‚’ç‰¹å®š

---

## å‚è€ƒæƒ…å ±

- [Playwright System Requirements](https://playwright.dev/docs/intro#system-requirements)
- [Playwright Test Configuration](https://playwright.dev/docs/test-configuration)
- ãƒ†ã‚¹ãƒˆãƒ­ã‚°: `/tmp/e2e-test-output.log`

---

## ä¿®å¾©è©¦è¡Œãƒ­ã‚°

### è©¦è¡Œ1: Chromiumãƒ–ãƒ©ã‚¦ã‚¶ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
npx playwright install chromium
```
**çµæœ**: ãƒ–ãƒ©ã‚¦ã‚¶ãƒã‚¤ãƒŠãƒªã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã€‚å…±æœ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒªä¸è¶³ã§èµ·å‹•å¤±æ•—ã€‚

### è©¦è¡Œ2: ä¾å­˜é–¢ä¿‚ã®è‡ªå‹•ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
npx playwright install-deps chromium
```
**çµæœ**: sudoãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒå¿…è¦ã§è‡ªå‹•å®Ÿè¡Œä¸å¯ã€‚æ‰‹å‹•å®Ÿè¡ŒãŒå¿…è¦ã€‚

### è©¦è¡Œ3: ãƒ–ãƒ©ã‚¦ã‚¶URLè¨­å®šä¿®æ­£
- `localhost:5173` â†’ `192.168.0.187:5173`

**çµæœ**: è¨­å®šã¯ä¿®æ­£æ¸ˆã¿ã€‚ä¾å­˜é–¢ä¿‚å•é¡Œã«ã‚ˆã‚Šæœªæ¤œè¨¼ã€‚

---

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### Q: ãƒ†ã‚¹ãƒˆãŒå…¨ã¦å¤±æ•—ã™ã‚‹
A: ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ä¿®å¾©æ‰‹é †ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚

### Q: Xvfbã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹
A: Playwrightã®headlessãƒ¢ãƒ¼ãƒ‰ã§ã¯ä¸è¦ã§ã™ãŒã€headedãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ã†å ´åˆã¯ä»¥ä¸‹ã‚’å®Ÿè¡Œ:
```bash
sudo apt-get install xvfb
xvfb-run npm run test:e2e
```

### Q: ãƒ‘ãƒ¼ãƒŸãƒƒã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼
A: Playwrightã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®æ¨©é™ã‚’ç¢ºèª:
```bash
ls -la ~/.cache/ms-playwright/
```

---

**ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: ğŸ”´ **ãƒ–ãƒ­ãƒƒã‚¯ä¸­** - ã‚·ã‚¹ãƒ†ãƒ ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå¿…è¦
**æ‹…å½“è€…ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**: ä¿®å¾©æ‰‹é †1ã¾ãŸã¯ä»£æ›¿æ‰‹é †ã‚’å®Ÿè¡Œå¾Œã€ãƒ†ã‚¹ãƒˆã‚’å†å®Ÿè¡Œ
