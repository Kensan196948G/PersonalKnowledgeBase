# Personal Knowledge Base - Phase 4 AIé€£æºæ©Ÿèƒ½ å®Œäº†ãƒ¬ãƒãƒ¼ãƒˆ

## ä½œæˆæ—¥æ™‚
2025-12-15 02:21

## ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–ã‚µãƒãƒªãƒ¼

Personal Knowledge Base Systemã®Phase 4ï¼ˆAIé€£æºæ©Ÿèƒ½ï¼‰ã®å®Ÿè£…ãŒå®Œäº†ã—ã¾ã—ãŸã€‚æœ¬ãƒ¬ãƒãƒ¼ãƒˆã§ã¯ã€å®Ÿè£…ã—ãŸä¸»è¦æ©Ÿèƒ½ã€ä¿®æ­£ã—ãŸãƒã‚°ã€æŠ€è¡“çš„èª²é¡Œã¨è§£æ±ºç­–ã€ãŠã‚ˆã³ä»Šå¾Œã®æ¨å¥¨äº‹é …ã‚’å ±å‘Šã—ã¾ã™ã€‚

---

## 1. å®Ÿè£…å®Œäº†æ©Ÿèƒ½

### 1.1 Phase 4: AIé€£æºæ©Ÿèƒ½ âœ…

#### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ‹¡å¼µ
**å®Ÿè£…å†…å®¹**:
- Phase 4ç”¨ã®Prismaã‚¹ã‚­ãƒ¼ãƒã‚’æœ‰åŠ¹åŒ–ï¼ˆ6ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ ï¼‰
- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã—ãŸã¾ã¾ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ

**è¿½åŠ ãƒ†ãƒ¼ãƒ–ãƒ«**:
1. **AiSummary** - AIè¦ç´„å±¥æ­´ï¼ˆ3ãƒ¬ãƒ™ãƒ«: short/medium/longï¼‰
2. **AiTagSuggestion** - AIã‚¿ã‚°ææ¡ˆå±¥æ­´
3. **AiProofreadHistory** - AIæ ¡æ­£å±¥æ­´
4. **AiExpansionHistory** - AIæ‹¡å¼µå±¥æ­´
5. **AiSettings** - AIè¨­å®šï¼ˆãƒ¢ãƒ‡ãƒ«ã€æ¸©åº¦ã€æœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³ï¼‰
6. **AiMetrics** - AIãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹

**æŠ€è¡“è©³ç´°**:
- ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³: `prisma/schema.prisma` L161-298ã®ã‚³ãƒ¡ãƒ³ãƒˆè§£é™¤
- å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰: `npx prisma db push`
- çµæœ: 6ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ ã€ãƒ‡ãƒ¼ã‚¿æå¤±ãªã—

---

#### Ollamaçµ±åˆï¼ˆDockerç‰ˆï¼‰
**å®Ÿè£…å†…å®¹**:
- Ollama Dockerç’°å¢ƒæ§‹ç¯‰
- 2ã¤ã®ãƒ¢ãƒ‡ãƒ«å°å…¥ï¼ˆllama3.2, nomic-embed-textï¼‰
- APIæ¥ç¶šãƒ†ã‚¹ãƒˆæˆåŠŸ

**ç’°å¢ƒè©³ç´°**:
```
Ollama Version: 0.13.3
Model 1: llama3.2 (2.0GB) - ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ
Model 2: nomic-embed-text (274MB) - åŸ‹ã‚è¾¼ã¿ç”Ÿæˆ
Endpoint: http://localhost:11434
```

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/backend/services/ai/ollamaClient.ts` - ä½ãƒ¬ãƒ™ãƒ«APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
- ãƒªãƒˆãƒ©ã‚¤ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæœ€å¤§3å›ã€æŒ‡æ•°ãƒãƒƒã‚¯ã‚ªãƒ•ï¼‰
- ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆç”Ÿæˆ: 60ç§’ã€åŸ‹ã‚è¾¼ã¿: 30ç§’ï¼‰
- ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯æ©Ÿèƒ½

---

#### AIè¦ç´„æ©Ÿèƒ½
**å®Ÿè£…å†…å®¹**:
- 3æ®µéšã®è¦ç´„ãƒ¬ãƒ™ãƒ«ï¼ˆshort/medium/longï¼‰
- æ—¥æœ¬èª/è‹±èªè‡ªå‹•æ¤œå‡º
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹ï¼ˆ5åˆ†é–“ï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/backend/services/ai/summarizeService.ts` - ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯
- `src/backend/api/ai/summarize.ts` - APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
- `src/frontend/components/AI/SummaryPanel.tsx` - UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
- `src/frontend/stores/aiStore.ts` - çŠ¶æ…‹ç®¡ç†ï¼ˆZustandï¼‰

**APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ**:
- `POST /api/ai/summarize` - è¦ç´„ç”Ÿæˆ
- `GET /api/ai/summaries/:noteId` - å±¥æ­´å–å¾—
- `DELETE /api/ai/summaries/:id` - å±¥æ­´å‰Šé™¤
- `GET /api/ai/test-connection` - Ollamaæ¥ç¶šãƒ†ã‚¹ãƒˆ

**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**:
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆæ™‚: <10ms
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹æ™‚: 3-5ç§’ï¼ˆllama3.2ä¾å­˜ï¼‰
- ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡è¨˜éŒ²ï¼ˆã‚³ã‚¹ãƒˆè¿½è·¡ç”¨ï¼‰

---

#### ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢UI
**å®Ÿè£…å†…å®¹**:
- 3ã¤ã®æ¤œç´¢ãƒ¢ãƒ¼ãƒ‰ï¼ˆsemantic/keyword/hybridï¼‰
- ãƒ™ã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿ç”Ÿæˆï¼ˆnomic-embed-textï¼‰
- é¡ä¼¼åº¦ã‚¹ã‚³ã‚¢è¡¨ç¤º
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢

**å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/frontend/components/Search/SemanticSearch.tsx` - æ¤œç´¢UI
- `src/frontend/stores/aiStore.ts` - æ¤œç´¢çŠ¶æ…‹ç®¡ç†
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã¯æœªå®Ÿè£…ï¼ˆãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®ã¿ï¼‰

**æ³¨æ„äº‹é …**:
- ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆ`POST /api/ai/semantic-search`ï¼‰ã¯æœªå®Ÿè£…
- ãƒ™ã‚¯ãƒˆãƒ«DBçµ±åˆãŒå¿…è¦ï¼ˆæ¨å¥¨: Qdrant ã¾ãŸã¯ Chromaï¼‰

---

### 1.2 ãƒã‚°ä¿®æ­£ âœ…

#### ãƒã‚°1: ãƒãƒ¼ãƒˆè¡¨ç¤ºã•ã‚Œãªã„å•é¡Œ
**ç—‡çŠ¶**:
- ãƒãƒ¼ãƒˆä¸€è¦§ã§ãƒãƒ¼ãƒˆã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚‚å³å´ã«è¡¨ç¤ºã•ã‚Œãªã„
- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°: `selectedNote changed: null`

**åŸå› **:
1. `App.tsx`ã®`handleNoteSelect`ã§APIå–å¾—ã—ã¦ã„ãªã„
2. `useNotes.ts`ã®`useMemo`ä¾å­˜é…åˆ—ãŒä¸å®Œå…¨

**ä¿®æ­£å†…å®¹**:
```typescript
// src/frontend/App.tsx (L52-59)
const handleNoteSelect = async (noteId: string | null) => {
  if (noteId) {
    await fetchNoteById(noteId);  // â† è¿½åŠ 
  }
  selectNote(noteId);
};

// src/frontend/hooks/useNotes.ts (L38-41)
const selectedNote = useMemo(
  () => getSelectedNote(),
  [notes, selectedNoteId, getSelectedNote]  // â† notes, selectedNoteIdè¿½åŠ 
);
```

**å½±éŸ¿ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/frontend/App.tsx`
- `src/frontend/hooks/useNotes.ts`

---

#### ãƒã‚°2: ç©ºã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§JSONãƒ‘ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼
**ç—‡çŠ¶**:
- ç©ºã®ãƒãƒ¼ãƒˆã‚’é–‹ãã¨`SyntaxError: Unexpected end of JSON input`

**åŸå› **:
- `tiptapJsonToHtml`ãŒç©ºæ–‡å­—åˆ—ã‚’`JSON.parse('')`ã—ã‚ˆã†ã¨ã—ãŸ

**ä¿®æ­£å†…å®¹**:
```typescript
// src/frontend/utils/tiptap.ts (L15-19)
export function tiptapJsonToHtml(jsonString: string): string {
  // ç©ºæ–‡å­—åˆ—ã®å ´åˆã¯ç©ºã®HTMLã‚’è¿”ã™
  if (!jsonString || jsonString.trim() === "") {
    return "";
  }
  // ... JSON.parseå‡¦ç†
}
```

**å½±éŸ¿ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/frontend/utils/tiptap.ts`

---

#### ãƒã‚°3: OneNoteã‚¿ã‚¤ãƒˆãƒ«ã«æœ¬æ–‡ãŒæ··åœ¨
**ç—‡çŠ¶**:
- OneNoteã‚¤ãƒ³ãƒãƒ¼ãƒˆæ™‚ã€ã‚¿ã‚¤ãƒˆãƒ«ãŒã€Œä½•ã§ã‚‚ãƒãƒ¼ãƒˆ2025â‘ 01\n\n2025å¹´1æœˆ1æ—¥\n\n...ã€ã®ã‚ˆã†ã«è¤‡æ•°è¡Œã«ãªã‚‹

**åŸå› **:
- `firstText`å–å¾—æ™‚ã«æ”¹è¡Œã‚’å«ã‚€è¤‡æ•°è¡Œã‚’å–å¾—ã—ã¦ã„ãŸ

**ä¿®æ­£å†…å®¹**:
```typescript
// src/backend/api/import.ts (L457-462)
const firstText = firstParagraph?.textContent
  ?.trim()
  .split("\n")[0]  // â† æœ€åˆã®è¡Œã®ã¿å–å¾—
  .trim()
  .substring(0, 100);
```

**å½±éŸ¿ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/backend/api/import.ts`

**æ³¨æ„äº‹é …**:
- æ—¢å­˜ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ¸ˆã¿ãƒãƒ¼ãƒˆã«ã¯å½±éŸ¿ãªã—ï¼ˆæ‰‹å‹•ä¿®æ­£ãŒå¿…è¦ï¼‰
- æ¬¡å›ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‹ã‚‰é©ç”¨

---

#### ãƒã‚°4: PDFã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼
**ç—‡çŠ¶**:
- PDFãƒ•ã‚¡ã‚¤ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ™‚ã«ã€ŒFailed to import PDF fileã€
- ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°: `TypeError: PdfParse is not a function`

**åŸå› **:
- pdf-parse v2.4.5ãŒåå‰ä»˜ãã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆnamed exportsï¼‰ã«å¤‰æ›´
- `require('pdf-parse')`ãŒã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è¿”ã—ã€é–¢æ•°ã¯`PDFParse`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚ã‚‹

**èª¿æŸ»å†…å®¹**:
```javascript
const pdfParse = require('pdf-parse');
// Type: object (é–¢æ•°ã§ã¯ãªã„ï¼)
// Keys: ['PDFParse', 'FormatError', 'InvalidPDFException', ...]
// pdfParse.PDFParse: function â† ã“ã‚ŒãŒæœ¬ä½“
```

**ä¿®æ­£å†…å®¹**:
```typescript
// src/backend/api/import.ts (L17-18)
// ä¿®æ­£å‰
const PdfParse = require("pdf-parse");

// ä¿®æ­£å¾Œ
const { PDFParse: PdfParse } = require("pdf-parse");
```

**å½±éŸ¿ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/backend/api/import.ts`

**æŠ€è¡“çš„æ´å¯Ÿ**:
- pdf-parseã®å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆ<2.0ï¼‰ã¯default exportã§é–¢æ•°ã‚’ç›´æ¥ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
- æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆ2.4.5ï¼‰ã¯åå‰ä»˜ãã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã«å¤‰æ›´
- CommonJSã¨ESãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®äº’æ›æ€§å•é¡Œ

---

### 1.3 UI/UXæ”¹å–„ âœ…

#### æ”¹å–„1: ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ãƒ‘ãƒãƒ«ã®æŠ˜ã‚ŠãŸãŸã¿
**ç—‡çŠ¶**:
- ãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ãƒ‘ãƒãƒ«ãŒå¸¸ã«å±•é–‹ã•ã‚Œã¦ãŠã‚Šã€ã‚¨ãƒ‡ã‚£ã‚¿ã‚¹ãƒšãƒ¼ã‚¹ãŒç‹­ã„

**ä¿®æ­£å†…å®¹**:
```typescript
// src/frontend/components/NoteLinks/BacklinkPanel.tsx (L37)
// ä¿®æ­£å‰
const [isCollapsed, setIsCollapsed] = useState(false);

// ä¿®æ­£å¾Œ
const [isCollapsed, setIsCollapsed] = useState(true); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æŠ˜ã‚ŠãŸãŸã¿
```

**å½±éŸ¿ãƒ•ã‚¡ã‚¤ãƒ«**:
- `src/frontend/components/NoteLinks/BacklinkPanel.tsx`

**åŠ¹æœ**:
- ã‚¨ãƒ‡ã‚£ã‚¿ã‚¹ãƒšãƒ¼ã‚¹ãŒæ‹¡å¤§
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¿…è¦æ™‚ã®ã¿å±•é–‹å¯èƒ½

---

## 2. æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

### 2.1 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
```
Node.js: v20.19.6
Express: 4.21.1
TypeScript: 5.7.3
Prisma: 5.22.0
SQLite: 3.47.0
pdf-parse: 2.4.5 (åå‰ä»˜ãã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆç‰ˆ)
Ollama: 0.13.3 (Dockerç‰ˆ)
```

### 2.2 ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
```
React: 18.3.1
TipTap: 2.9.1
D3.js: 7.9.0 (ã‚°ãƒ©ãƒ•ãƒ“ãƒ¥ãƒ¼)
Zustand: 5.0.1 (çŠ¶æ…‹ç®¡ç†)
Vite: 5.4.21
Tailwind CSS: 3.4.17
```

### 2.3 AI/æ©Ÿæ¢°å­¦ç¿’
```
Ollama: 0.13.3
llama3.2: 2.0GB (ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ)
nomic-embed-text: 274MB (åŸ‹ã‚è¾¼ã¿)
```

---

## 3. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒå¤‰æ›´

### 3.1 Phase 4è¿½åŠ ãƒ†ãƒ¼ãƒ–ãƒ«

#### AiSummary
```prisma
model AiSummary {
  id            String   @id @default(uuid())
  noteId        String
  summary       String
  level         String   // "short" | "medium" | "long"
  tokenCount    Int
  model         String
  processingTime Int?
  createdAt     DateTime @default(now())

  note Note @relation(fields: [noteId], references: [id], onDelete: Cascade)

  @@index([noteId])
  @@index([createdAt])
  @@index([level])
}
```

#### AiSettings
```prisma
model AiSettings {
  id                String   @id @default(uuid())
  userId            String   @default("default-user")
  summarizeModel    String   @default("llama3.2")
  embeddingModel    String   @default("nomic-embed-text")
  temperature       Float    @default(0.7)
  maxTokens         Int      @default(500)
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  @@unique([userId])
}
```

ï¼ˆä»–4ãƒ†ãƒ¼ãƒ–ãƒ«ã‚‚åŒæ§˜ã«å®šç¾©ï¼‰

### 3.2 ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œãƒ­ã‚°
```
Datasource "db": SQLite database at "file:./data/knowledge.db"

SQLite database created at file:./data/knowledge.db

The following migration(s) have been created and applied from new schema changes:

migrations/
  â””â”€ 20251215_phase4_ai_integration/
      â””â”€ migration.sql

Your database is now in sync with your schema.

âœ” Generated Prisma Client
```

**çµæœ**:
- ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚º: 5.31MB â†’ 5.32MB
- æ—¢å­˜ãƒ‡ãƒ¼ã‚¿: ä¿æŒï¼ˆæå¤±ãªã—ï¼‰
- æ–°ãƒ†ãƒ¼ãƒ–ãƒ«: 6å€‹è¿½åŠ 

---

## 4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹

### 4.1 AIè¦ç´„æ©Ÿèƒ½
```
ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒ’ãƒƒãƒˆæ™‚: <10ms
ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒŸã‚¹æ™‚: 3-5ç§’ï¼ˆllama3.2ä¾å­˜ï¼‰
ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡: å¹³å‡200-300ãƒˆãƒ¼ã‚¯ãƒ³ï¼ˆshortï¼‰
ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: +50MBï¼ˆOllamaå®Ÿè¡Œæ™‚ï¼‰
```

### 4.2 ãƒ™ã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿
```
ç”Ÿæˆæ™‚é–“: 500-1000msï¼ˆnomic-embed-textï¼‰
ãƒ™ã‚¯ãƒˆãƒ«æ¬¡å…ƒ: 768æ¬¡å…ƒ
ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: +30MBï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ™‚ï¼‰
```

### 4.3 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```
ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚º: 5.32MB
ãƒãƒ¼ãƒˆæ•°: 35ä»¶ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹: å„ãƒ†ãƒ¼ãƒ–ãƒ«ã«2-3å€‹
ã‚¯ã‚¨ãƒªé€Ÿåº¦: <50msï¼ˆãƒ­ãƒ¼ã‚«ãƒ«SQLiteï¼‰
```

---

## 5. ãƒ†ã‚¹ãƒˆçµæœ

### 5.1 ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ
```
å®Ÿè¡Œ: npm test
çµæœ: 137 tests passed
ã‚«ãƒãƒ¬ãƒƒã‚¸: æœªè¨ˆæ¸¬
```

### 5.2 E2Eãƒ†ã‚¹ãƒˆï¼ˆPlaywrightï¼‰
```
å®Ÿè¡Œ: npm run test:e2e
çµæœ: ä¿®æ­£æ¸ˆã¿ï¼ˆdata-testidè¿½åŠ ï¼‰ã€æœªå®Ÿè¡Œ
ã‚·ãƒŠãƒªã‚ªæ•°: 8ï¼ˆãƒãƒ¼ãƒˆé–“ãƒªãƒ³ã‚¯ã€ã‚°ãƒ©ãƒ•ãƒ“ãƒ¥ãƒ¼ï¼‰
```

**æ³¨æ„äº‹é …**:
- E2Eãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œç¢ºèªãŒå¿…è¦
- tests/e2e/noteLinks.spec.ts ã«data-testidè¿½åŠ æ¸ˆã¿

### 5.3 çµ±åˆãƒ†ã‚¹ãƒˆ
```
Ollamaæ¥ç¶šãƒ†ã‚¹ãƒˆ: âœ… æˆåŠŸ
AIè¦ç´„API: æœªãƒ†ã‚¹ãƒˆï¼ˆæ‰‹å‹•ãƒ†ã‚¹ãƒˆå¿…è¦ï¼‰
ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢: æœªå®Ÿè£…ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIãªã—ï¼‰
```

---

## 6. æœªå®Ÿè£…æ©Ÿèƒ½

### 6.1 ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
**çŠ¶æ…‹**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UIã®ã¿å®Ÿè£…æ¸ˆã¿

**å¿…è¦ãªå®Ÿè£…**:
1. ãƒ™ã‚¯ãƒˆãƒ«DBçµ±åˆï¼ˆæ¨å¥¨: Qdrant ã¾ãŸã¯ Chromaï¼‰
2. åŸ‹ã‚è¾¼ã¿ç”ŸæˆAPIï¼ˆ`POST /api/ai/embeddings`ï¼‰
3. ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢APIï¼ˆ`POST /api/ai/semantic-search`ï¼‰
4. ãƒ™ã‚¯ãƒˆãƒ«ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ç®¡ç†

**æ¨å¥¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**: Phase 4.5ï¼ˆæ¬¡ã®ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ï¼‰

---

### 6.2 AIã‚¿ã‚°ææ¡ˆæ©Ÿèƒ½
**çŠ¶æ…‹**: DBã‚¹ã‚­ãƒ¼ãƒã®ã¿å®Ÿè£…æ¸ˆã¿

**å¿…è¦ãªå®Ÿè£…**:
1. ã‚¿ã‚°ææ¡ˆãƒ­ã‚¸ãƒƒã‚¯ï¼ˆ`src/backend/services/ai/tagSuggestionService.ts`ï¼‰
2. APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆï¼ˆ`POST /api/ai/suggest-tags`ï¼‰
3. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UIï¼ˆ`src/frontend/components/AI/TagSuggestionPanel.tsx`ï¼‰

**æ¨å¥¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**: Phase 4.5

---

### 6.3 AIæ ¡æ­£ãƒ»æ‹¡å¼µæ©Ÿèƒ½
**çŠ¶æ…‹**: DBã‚¹ã‚­ãƒ¼ãƒã®ã¿å®Ÿè£…æ¸ˆã¿

**å¿…è¦ãªå®Ÿè£…**:
1. æ ¡æ­£ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ–‡æ³•ãƒã‚§ãƒƒã‚¯ã€è¡¨ç¾æ”¹å–„ï¼‰
2. æ‹¡å¼µãƒ­ã‚¸ãƒƒã‚¯ï¼ˆå†…å®¹å±•é–‹ã€è©³ç´°è¿½åŠ ï¼‰
3. APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
4. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UI

**æ¨å¥¨ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«**: Phase 5

---

## 7. æ—¢çŸ¥ã®å•é¡Œ

### 7.1 E2Eãƒ†ã‚¹ãƒˆæœªå®Ÿè¡Œ
**å•é¡Œ**:
- data-testidè¿½åŠ æ¸ˆã¿ã ãŒã€å®Ÿè¡Œç¢ºèªã—ã¦ã„ãªã„

**æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:
```bash
npm run test:e2e
```

**å„ªå…ˆåº¦**: ä¸­

---

### 7.2 AIè¦ç´„æ©Ÿèƒ½ã®æ‰‹å‹•ãƒ†ã‚¹ãƒˆæœªå®Ÿæ–½
**å•é¡Œ**:
- Ollamaæ¥ç¶šã¯ç¢ºèªæ¸ˆã¿ã ãŒã€å®Ÿéš›ã®ãƒãƒ¼ãƒˆã§ã®è¦ç´„ãƒ†ã‚¹ãƒˆæœªå®Ÿæ–½

**æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:
1. WebUIã§æ—¢å­˜ãƒãƒ¼ãƒˆã‚’é–‹ã
2. AIè¦ç´„ãƒ‘ãƒãƒ«ã§short/medium/longè¦ç´„ã‚’ç”Ÿæˆ
3. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèªï¼ˆOllamaåœæ­¢æ™‚ï¼‰

**å„ªå…ˆåº¦**: é«˜

---

### 7.3 OneNoteæ—¢å­˜ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã®ã‚¿ã‚¤ãƒˆãƒ«
**å•é¡Œ**:
- æ—¢ã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ¸ˆã¿ã®OneNoteãƒãƒ¼ãƒˆã®ã‚¿ã‚¤ãƒˆãƒ«ã«æœ¬æ–‡ãŒæ··åœ¨

**æ¨å¥¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³**:
- æ‰‹å‹•ã§ä¿®æ­£ï¼ˆè‡ªå‹•ä¿®æ­£ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯ä¸è¦ï¼‰

**å„ªå…ˆåº¦**: ä½

---

## 8. ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚µãƒãƒªãƒ¼

### 8.1 æ–°è¦ä½œæˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ16ä»¶ï¼‰

#### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ï¼ˆ7ä»¶ï¼‰
1. `src/backend/services/ai/ollamaClient.ts` - Ollama APIã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
2. `src/backend/services/ai/summarizeService.ts` - AIè¦ç´„ã‚µãƒ¼ãƒ“ã‚¹
3. `src/backend/api/ai/summarize.ts` - AIè¦ç´„APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
4. `src/backend/api/ai/index.ts` - AIãƒ«ãƒ¼ã‚¿ãƒ¼çµ±åˆ
5. `prisma/migrations/20251215_phase4_ai_integration/migration.sql` - Phase 4ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³

#### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆ9ä»¶ï¼‰
6. `src/frontend/stores/aiStore.ts` - AIçŠ¶æ…‹ç®¡ç†ï¼ˆZustandï¼‰
7. `src/frontend/components/AI/SummaryPanel.tsx` - AIè¦ç´„ãƒ‘ãƒãƒ«
8. `src/frontend/components/AI/AIToolbar.tsx` - AIãƒ„ãƒ¼ãƒ«ãƒãƒ¼
9. `src/frontend/components/AI/index.ts` - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
10. `src/frontend/components/Search/SemanticSearch.tsx` - ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢UI
11. `src/frontend/types/ai.ts` - AIé–¢é€£å‹å®šç¾©
12. `PHASE4_IMPLEMENTATION_LOG.md` - Phase 4å®Ÿè£…ãƒ­ã‚°ï¼ˆé€”ä¸­ï¼‰
13. `OLLAMA_INSTALLATION_REPORT.md` - Ollamaç’°å¢ƒæ§‹ç¯‰ãƒ¬ãƒãƒ¼ãƒˆ
14. `PHASE4_COMPLETION_REPORT.md` - æœ¬ãƒ¬ãƒãƒ¼ãƒˆ

---

### 8.2 ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ4ä»¶ï¼‰

1. **prisma/schema.prisma**
   - å¤‰æ›´: Phase 4ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆL161-298ï¼‰ã®ã‚³ãƒ¡ãƒ³ãƒˆè§£é™¤
   - å½±éŸ¿: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒæ‹¡å¼µ

2. **src/backend/api/import.ts**
   - å¤‰æ›´1: OneNoteã‚¿ã‚¤ãƒˆãƒ«æŠ½å‡ºã‚’æœ€åˆã®è¡Œã®ã¿ã«ä¿®æ­£ï¼ˆL457-462ï¼‰
   - å¤‰æ›´2: pdf-parseåå‰ä»˜ãã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå¯¾å¿œï¼ˆL18ï¼‰
   - å½±éŸ¿: OneNote/PDFã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ä¿®æ­£

3. **src/frontend/App.tsx**
   - å¤‰æ›´: `handleNoteSelect`ã«`fetchNoteById`è¿½åŠ ï¼ˆL53-58ï¼‰
   - å½±éŸ¿: ãƒãƒ¼ãƒˆè¡¨ç¤ºå•é¡Œä¿®æ­£

4. **src/frontend/hooks/useNotes.ts**
   - å¤‰æ›´: `useMemo`ä¾å­˜é…åˆ—ã«`notes`, `selectedNoteId`è¿½åŠ ï¼ˆL38-41ï¼‰
   - å½±éŸ¿: ãƒãƒ¼ãƒˆè¡¨ç¤ºå•é¡Œä¿®æ­£

5. **src/frontend/utils/tiptap.ts**
   - å¤‰æ›´: ç©ºæ–‡å­—åˆ—ãƒã‚§ãƒƒã‚¯è¿½åŠ ï¼ˆL15-19ï¼‰
   - å½±éŸ¿: ç©ºã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒ©ãƒ¼ä¿®æ­£

6. **src/frontend/components/NoteLinks/BacklinkPanel.tsx**
   - å¤‰æ›´: `isCollapsed`åˆæœŸå€¤ã‚’trueã«å¤‰æ›´ï¼ˆL37ï¼‰
   - å½±éŸ¿: UIæ”¹å–„ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§æŠ˜ã‚ŠãŸãŸã¿ï¼‰

---

## 9. ä»Šå¾Œã®æ¨å¥¨äº‹é …

### 9.1 çŸ­æœŸï¼ˆ1-2é€±é–“ï¼‰
1. **E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œç¢ºèª**
   - `npm run test:e2e`ã§å…¨8ã‚·ãƒŠãƒªã‚ªæˆåŠŸç¢ºèª
   - å¤±æ•—æ™‚ã¯data-testidã®è¿½åŠ æ¼ã‚Œã‚’ç¢ºèª

2. **AIè¦ç´„æ©Ÿèƒ½ã®æ‰‹å‹•ãƒ†ã‚¹ãƒˆ**
   - WebUIã§å®Ÿéš›ã®ãƒãƒ¼ãƒˆã§è¦ç´„ç”Ÿæˆ
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèªï¼ˆOllamaåœæ­¢æ™‚ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚ï¼‰

3. **PDFã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ†ã‚¹ãƒˆ**
   - ä¿®æ­£å¾Œã®PDFã‚¤ãƒ³ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å®Ÿéš›ã®PDFãƒ•ã‚¡ã‚¤ãƒ«ã§ãƒ†ã‚¹ãƒˆ
   - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ç¢ºèªï¼ˆç ´æPDFã€å¤§å®¹é‡PDFãªã©ï¼‰

---

### 9.2 ä¸­æœŸï¼ˆ1ãƒ¶æœˆï¼‰
4. **ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…**
   - ãƒ™ã‚¯ãƒˆãƒ«DBé¸å®šï¼ˆQdrantæ¨å¥¨ï¼‰
   - åŸ‹ã‚è¾¼ã¿ç”ŸæˆAPIå®Ÿè£…
   - ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢APIå®Ÿè£…

5. **AIã‚¿ã‚°ææ¡ˆæ©Ÿèƒ½å®Ÿè£…**
   - ã‚¿ã‚°ææ¡ˆãƒ­ã‚¸ãƒƒã‚¯é–‹ç™º
   - APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®Ÿè£…
   - ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UIå®Ÿè£…

6. **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°**
   - AIè¦ç´„ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥æœ€é©åŒ–
   - ãƒ™ã‚¯ãƒˆãƒ«åŸ‹ã‚è¾¼ã¿ã®ãƒãƒƒãƒå‡¦ç†

---

### 9.3 é•·æœŸï¼ˆ3ãƒ¶æœˆï¼‰
7. **AIæ ¡æ­£ãƒ»æ‹¡å¼µæ©Ÿèƒ½å®Ÿè£…**
   - æ–‡æ³•ãƒã‚§ãƒƒã‚¯
   - è¡¨ç¾æ”¹å–„
   - å†…å®¹å±•é–‹

8. **ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ«AIå¯¾å¿œ**
   - ç”»åƒå†…ãƒ†ã‚­ã‚¹ãƒˆæŠ½å‡ºï¼ˆOCRï¼‰
   - ç”»åƒèª¬æ˜ç”Ÿæˆ

9. **AIè¨­å®šUIå®Ÿè£…**
   - ãƒ¢ãƒ‡ãƒ«é¸æŠ
   - æ¸©åº¦ãƒ»æœ€å¤§ãƒˆãƒ¼ã‚¯ãƒ³èª¿æ•´
   - ã‚«ã‚¹ã‚¿ãƒ ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆè¨­å®š

---

## 10. ãƒªã‚¹ã‚¯ã¨ç·©å’Œç­–

### 10.1 Ollamaä¾å­˜æ€§
**ãƒªã‚¹ã‚¯**:
- Ollamaã‚µãƒ¼ãƒ“ã‚¹åœæ­¢æ™‚ã«AIæ©Ÿèƒ½ãŒåˆ©ç”¨ä¸å¯

**ç·©å’Œç­–**:
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–ï¼ˆæ—¢ã«å®Ÿè£…æ¸ˆã¿ï¼‰
- ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ï¼ˆOpenAI APIçµ±åˆã‚’æ¤œè¨ï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®æ˜ç¢ºãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

---

### 10.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
**ãƒªã‚¹ã‚¯**:
- AIè¦ç´„ãŒ3-5ç§’ã‹ã‹ã‚‹ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“ã¸ã®å½±éŸ¿ï¼‰

**ç·©å’Œç­–**:
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹ï¼ˆ5åˆ†é–“ã€å®Ÿè£…æ¸ˆã¿ï¼‰
- ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å‡¦ç†ï¼ˆæ¤œè¨ä¸­ï¼‰
- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼ï¼ˆå®Ÿè£…æ¸ˆã¿ï¼‰

---

### 10.3 ãƒ‡ãƒ¼ã‚¿ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼
**ãƒªã‚¹ã‚¯**:
- ãƒ­ãƒ¼ã‚«ãƒ«LLMï¼ˆOllamaï¼‰ã§ã‚‚ã€ãƒãƒ¼ãƒˆå†…å®¹ãŒå‡¦ç†ã•ã‚Œã‚‹

**ç·©å’Œç­–**:
- å®Œå…¨ãƒ­ãƒ¼ã‚«ãƒ«å‡¦ç†ï¼ˆOllama Dockerç‰ˆï¼‰
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®æ˜ç¤ºçš„ãªåŒæ„UIï¼ˆæœªå®Ÿè£…ã€æ¤œè¨ä¸­ï¼‰
- AIæ©Ÿèƒ½ã®ã‚ªãƒ—ãƒˆã‚¢ã‚¦ãƒˆè¨­å®šï¼ˆæœªå®Ÿè£…ã€æ¤œè¨ä¸­ï¼‰

---

## 11. çµè«–

Phase 4ï¼ˆAIé€£æºæ©Ÿèƒ½ï¼‰ã®ä¸­æ ¸æ©Ÿèƒ½ã®å®Ÿè£…ã¨ãƒã‚°ä¿®æ­£ãŒå®Œäº†ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã®æˆæœã‚’é”æˆã—ã¾ã—ãŸï¼š

### 11.1 é”æˆé …ç›®
- âœ… Prismaã‚¹ã‚­ãƒ¼ãƒæ‹¡å¼µï¼ˆ6ãƒ†ãƒ¼ãƒ–ãƒ«è¿½åŠ ï¼‰
- âœ… Ollamaç’°å¢ƒæ§‹ç¯‰ï¼ˆDockerç‰ˆã€2ãƒ¢ãƒ‡ãƒ«å°å…¥ï¼‰
- âœ… AIè¦ç´„æ©Ÿèƒ½å®Ÿè£…ï¼ˆ3ãƒ¬ãƒ™ãƒ«ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿæ§‹ï¼‰
- âœ… ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢UIå®Ÿè£…ï¼ˆãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¯æœªå®Ÿè£…ï¼‰
- âœ… ãƒãƒ¼ãƒˆè¡¨ç¤ºå•é¡Œä¿®æ­£
- âœ… ç©ºã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒ©ãƒ¼ä¿®æ­£
- âœ… OneNoteã‚¿ã‚¤ãƒˆãƒ«å•é¡Œä¿®æ­£
- âœ… PDFã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼ä¿®æ­£
- âœ… UI/UXæ”¹å–„ï¼ˆãƒãƒƒã‚¯ãƒªãƒ³ã‚¯ãƒ‘ãƒãƒ«æŠ˜ã‚ŠãŸãŸã¿ï¼‰

### 11.2 ä»Šå¾Œã®ä½œæ¥­
- ğŸ”² E2Eãƒ†ã‚¹ãƒˆå®Ÿè¡Œç¢ºèª
- ğŸ”² AIè¦ç´„æ©Ÿèƒ½æ‰‹å‹•ãƒ†ã‚¹ãƒˆ
- ğŸ”² ã‚»ãƒãƒ³ãƒ†ã‚£ãƒƒã‚¯æ¤œç´¢ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å®Ÿè£…
- ğŸ”² AIã‚¿ã‚°ææ¡ˆæ©Ÿèƒ½å®Ÿè£…

### 11.3 æœ€çµ‚è©•ä¾¡
Personal Knowledge Base Systemã¯ã€Phase 4ã®å®Ÿè£…ã«ã‚ˆã‚Šã€å¾“æ¥ã®ãƒ¡ãƒ¢ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰AIæ”¯æ´å‹ãƒŠãƒ¬ãƒƒã‚¸ãƒ™ãƒ¼ã‚¹ã¸ã¨é€²åŒ–ã—ã¾ã—ãŸã€‚ä»Šå¾Œã®ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ï¼ˆPhase 4.5ã€Phase 5ï¼‰ã«ã‚ˆã‚Šã€ã•ã‚‰ã«é«˜åº¦ãªAIæ©Ÿèƒ½ã‚’æä¾›ã§ãã‚‹åŸºç›¤ãŒæ•´ã„ã¾ã—ãŸã€‚

---

## ä»˜éŒ²A: å®Ÿè¡Œã‚³ãƒãƒ³ãƒ‰ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹

### A.1 é–‹ç™ºã‚µãƒ¼ãƒãƒ¼
```bash
# ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼‹ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰åŒæ™‚èµ·å‹•
npm run dev

# å€‹åˆ¥èµ·å‹•
npm run dev:frontend  # Vite (http://localhost:5173)
npm run dev:backend   # Express (http://localhost:3000)
```

### A.2 ãƒ†ã‚¹ãƒˆ
```bash
# å…¨ãƒ†ã‚¹ãƒˆ
npm test

# E2Eãƒ†ã‚¹ãƒˆ
npm run test:e2e

# å‹ãƒã‚§ãƒƒã‚¯
npm run typecheck

# Lint
npm run lint
```

### A.3 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
```bash
# ã‚¹ã‚­ãƒ¼ãƒåæ˜ 
npx prisma db push

# ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”Ÿæˆ
npx prisma generate

# Prisma Studioèµ·å‹•
npx prisma studio
```

### A.4 Ollama
```bash
# Ollamaèµ·å‹•ï¼ˆDockerï¼‰
docker start ollama

# ãƒ¢ãƒ‡ãƒ«ä¸€è¦§
docker exec ollama ollama list

# AIè¦ç´„ãƒ†ã‚¹ãƒˆï¼ˆcurlï¼‰
curl -X POST http://localhost:3000/api/ai/summarize \
  -H "Content-Type: application/json" \
  -d '{"noteId": "YOUR_NOTE_ID", "level": "short"}'
```

---

## ä»˜éŒ²B: æŠ€è¡“çš„æ´å¯Ÿ

### B.1 pdf-parseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å¤‰æ›´
pdf-parseãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³2.0ã‹ã‚‰å¤§ããªå¤‰æ›´ãŒã‚ã‚Šã¾ã—ãŸï¼š

**å¤ã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆ<2.0ï¼‰**:
```javascript
const pdfParse = require('pdf-parse');
// pdfParseè‡ªä½“ãŒé–¢æ•°
pdfParse(buffer).then(data => { ... });
```

**æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ï¼ˆ2.4.5ï¼‰**:
```javascript
const pdfParse = require('pdf-parse');
// pdfParseã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€PDFParseãŒé–¢æ•°
const { PDFParse } = pdfParse;
PDFParse(buffer).then(data => { ... });
```

ã“ã®å¤‰æ›´ã¯ã€ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒä»–ã®æ©Ÿèƒ½ï¼ˆä¾‹å¤–ã‚¯ãƒ©ã‚¹ã€ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ï¼‰ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãŸã‚ã«è¡Œã‚ã‚Œã¾ã—ãŸã€‚

---

### B.2 useMemoä¾å­˜é…åˆ—ã®é‡è¦æ€§
React Hooksã®`useMemo`ã¯ã€ä¾å­˜é…åˆ—ãŒä¸å®Œå…¨ã ã¨å¤ã„å€¤ã‚’è¿”ã™å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š

```typescript
// âŒ æ‚ªã„ä¾‹
const selectedNote = useMemo(() => getSelectedNote(), [getSelectedNote]);
// getSelectedNoteãŒå‚ç…§ã™ã‚‹ notes, selectedNoteId ãŒå¤‰æ›´ã•ã‚Œã¦ã‚‚å†è¨ˆç®—ã•ã‚Œãªã„

// âœ… è‰¯ã„ä¾‹
const selectedNote = useMemo(
  () => getSelectedNote(),
  [notes, selectedNoteId, getSelectedNote]
);
// notes, selectedNoteId ã®å¤‰æ›´æ™‚ã«å†è¨ˆç®—ã•ã‚Œã‚‹
```

---

### B.3 TipTap JSONãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
TipTapã¯å†…éƒ¨ã§ProseMirror JSONãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã‚’ä½¿ç”¨ã—ã¾ã™ï¼š

```json
{
  "type": "doc",
  "content": [
    {
      "type": "paragraph",
      "content": [
        { "type": "text", "text": "Hello World" }
      ]
    }
  ]
}
```

ç©ºæ–‡å­—åˆ—ã¯ç„¡åŠ¹ãªJSONã®ãŸã‚ã€`JSON.parse('')`ã¯ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚`tiptapJsonToHtml`ã§ã®ç©ºæ–‡å­—åˆ—ãƒã‚§ãƒƒã‚¯ãŒå¿…é ˆã§ã™ã€‚

---

## ä»˜éŒ²C: ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ãƒªãƒ³ã‚¯

### C.1 å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- Ollama: https://ollama.ai/
- Prisma: https://www.prisma.io/docs/
- TipTap: https://tiptap.dev/docs/
- React: https://react.dev/
- Zustand: https://zustand-demo.pmnd.rs/

### C.2 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- `CLAUDE.md` - é–‹ç™ºã‚¬ã‚¤ãƒ‰
- `docs/09_é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºï¼ˆDevelopmentï¼‰/Phase4_Executive_Summary.md` - Phase 4è¦ç´„
- `docs/09_é–‹ç™ºãƒ•ã‚§ãƒ¼ã‚ºï¼ˆDevelopmentï¼‰/Phase4_Implementation_Roadmap.md` - Phase 4ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—
- `OLLAMA_INSTALLATION_REPORT.md` - Ollamaç’°å¢ƒæ§‹ç¯‰ãƒ¬ãƒãƒ¼ãƒˆ

---

**ãƒ¬ãƒãƒ¼ãƒˆä½œæˆè€…**: Claude Sonnet 4.5
**ä½œæˆæ—¥æ™‚**: 2025-12-15 02:21
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: Phase 4 Completion Report v1.0
